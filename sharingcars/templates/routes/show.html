{% extends 'common/master-page/master-page.html' %}
{% block title %} SharingCars {% endblock %}
{% block jumbotron %}{% load staticfiles %}

    <div class="jumbotron">
          <div class="row">
              <div class="col-lg-12">
                  <div class="col-lg-4 text-center">
                      {% if route.user.photo == 'default' %}
                          <img class="img-circle img-responsive center-block"  src="{% static 'user/image/default.jpg' %}" style="width:auto;height:200px" alt="">
                      {% else %}
                          <img class="img-circle img-responsive center-block"  src="{% static route.user.photo %}" style="width:auto;height:200px" alt="">
                      {% endif %}
                  </div>
                  <div class="col-lg-8 text-center">
                      <div class="col-lg-12"><br></div>
                      <div class="col-lg-12"><br></div>
                      <div class="col-lg-12"><br></div>
                      <div class="col-lg-12"><br></div>
                      <div class="col-lg-6">
                         <b>Nombre:</b> <a href="/user/profile?userId={{ route.user.id }}">{{ route.user.name }} {{ route.user.surnames }}</a>
                      </div>
                      <div class="col-lg-6 text-center">
                          <b>Rutas publicadas:</b> {{ route.user.route_set.all|length }}
                      </div>
                      <div class="col-lg-6 text-center">
                          <b>Fecha de nacimiento:</b> {{ route.user.birthdate }}
                      </div>
                      <div class="col-lg-3 text-center">
                          <b>Rating: </b>{{rating}}/10
                      </div>
                      <div class="col-lg-3 text-center">
                          <b>Evaluaciones: </b>{{ quantity }}
                      </div>
                  </div>
              </div>
              <div class="col-lg-12 ">
                  <div class="col-lg-12 text-center">
                        <div class="col-lg-4">
                            <b>Tipo de anuncio: </b> {% if route.kind == "1" %}Oferta{% else %}Demanda{% endif %}
                        </div>
                        <div class="col-lg-2">
                            <b>{{ route.unitPrice }}<span class="glyphicon glyphicon-euro" aria-hidden="true"></span> por persona  </b>
                        </div>
                        <div class="col-lg-6">
                            <b>Publicaci�n: </b>{{ route.creationMoment }}
                        </div>
                    </div>
                  <div class="col-lg-1"></div>
                  <div class="col-lg-11 ">
                        <div class="col-lg-4">
                            <b>Origen: </b>{{ route.origin }}
                        </div>
                        <div class="col-lg-4">
                            <b>Destino: </b>{{ route.destination }}
                        </div>
                        <div class="col-lg-4">
                            <b>Plazas: </b>{{ route.seating }}
                        </div>
                    </div>

                    <div class="col-lg-12">
                        <div class="col-lg-1"></div>
                        <div class="col-lg-11">
                            <div class="col-lg-12">
                            <b>Descripci�n: </b>{{ route.description }}
                                </div>
                        </div>
                    </div>
              </div>
              <div class="col-lg-12">
                <div class="col-lg-12 text-center">
                            <h2>Horario</h2>
                        </div>
                            {% for day in route.day_set.all %}
                                {% if forloop.counter <= 4 %}
                                    <div class="col-lg-3 text-center">
                                        <div class="col-lg-12">
                                            {% if day.day == 1 %}
                                                <b>Lunes</b>
                                            {% elif day.day == 2 %}
                                                <b>Martes</b>
                                            {% elif day.day == 3 %}
                                                <b>Mi�rcoles</b>
                                            {% elif day.day == 4 %}
                                                <b>Jueves</b>
                                            {% endif %}
                                        </div>
                                        <div class="col-lg-12">
                                            {% if day.active %}
                                                <div class="text-success"><span class="glyphicon glyphicon-ok" aria-hidden="true"></span></div>
                                            {% else %}
                                                <div class="text-danger"><span class="glyphicon glyphicon-remove" aria-hidden="true"></span></div>
                                            {% endif %}
                                        </div>
                                        <div class="col-lg-12">
                                            {% if day.departTime != "" %}
                                                Salida: {{ day.departTime }}
                                            {% else %}
                                                <span class="text-warning glyphicon glyphicon-remove" aria-hidden="true"></span>
                                            {% endif %}
                                        </div>
                                        <div class="col-lg-12">
                                            {% if day.returnTime != "" %}
                                                Vuelta: {{ day.returnTime }}
                                            {% else %}
                                                <span class="text-warning glyphicon glyphicon-remove" aria-hidden="true"></span>
                                            {% endif %}
                                        </div>
                                    </div>
                                {% else %}
                                    <div class="col-lg-4 text-center">
                                        <div class="col-lg-12">
                                            {% if day.day == 5 %}
                                                <b>Viernes</b>
                                            {% elif day.day == 6 %}
                                                <b>S�bado</b>
                                            {% elif day.day == 7 %}
                                                <b>Domingo</b>
                                            {% endif %}
                                        </div>
                                        <div class="col-lg-12">
                                            {% if day.active %}
                                                <div class="text-success"><span class="glyphicon glyphicon-ok" aria-hidden="true"></span></div>
                                            {% else %}
                                                <div class="text-danger"><span class="glyphicon glyphicon-remove" aria-hidden="true"></span></div>
                                            {% endif %}
                                        </div>
                                        <div class="col-lg-12">
                                            {% if day.departTime != "" %}
                                                Salida: {{ day.departTime }}
                                            {% else %}
                                                <span class="text-warning glyphicon glyphicon-remove" aria-hidden="true"></span>
                                            {% endif %}
                                        </div>
                                        <div class="col-lg-12">
                                            {% if day.returnTime != "" %}
                                                Vuelta: {{ day.returnTime }}
                                            {% else %}
                                                <span class="text-warning glyphicon glyphicon-remove" aria-hidden="true"></span>
                                            {% endif %}
                                        </div>
                                    </div>
                                {% endif %}
                            {% endfor %}
                        </div>
                <div class="col-lg-12"><br></div>
                <div class="col-lg-12 text-center"><h2>Comentarios</h2> <b>Valoraci�n de la ruta: {{ ratingRoute }}/10</b></div>
                <div class="col-lg-12"><br></div>
                <div class="col-lg-12">
                    {% if route.commentroute_set.all|length > 0 %}
                        {% for comment in route.commentroute_set.all %}
                            <div class="col-lg-12">
                                <div class="col-lg-1"></div>
                                <div class="col-lg-11">
                                    <div class="col-lg-3">
                                        <b>Asunto: </b>{{ comment.subject }}
                                    </div>
                                    <div class="col-lg-3">
                                        <b>Valoraci�n: </b>{{ comment.rating }}
                                    </div>
                                </div>
                            </div>
                            <div class="col-lg-12">
                                <div class="col-lg-1"></div>
                                <div class="col-lg-11">
                                    <div class="col-lg-12">
                                        <b>Comentario: </b>{{ comment.comment }}
                                    </div>
                                </div>
                            </div>
                        {% endfor %}
                    {% else %}
                        <div class="col-lg-12 text-center">
                            <h2 class="text-danger">No hay comentarios para esta ruta.</h2>
                        </div>
                    {% endif %}
                    {% if applicationsRoute %}
                      <div class="col-lg-12"><br></div>
                      <div class="col-lg-12 text-center"><h2>Solicitudes</h2></div>
                      <div class="col-lg-12"><br></div>
                      {% for apply_route in applicationsRoute %}
                        <div class="col-lg-12">
                            <div class="col-lg-1"></div>
                            <div class="col-lg-11">
                                <div class="col-lg-3">
                                    <b>Usuario: </b>{{ apply_route.user }}
                                </div>
                                <div class="col-lg-3">
                                    <b>Estado: </b>{{ apply_route.get_state_display }}
                                </div>
                            </div>
                        </div>
                        <div class="col-lg-12">
                            <div class="col-lg-1"></div>
                            <div class="col-lg-11">
                                <div class="col-lg-12">
                                    <b>Comentario: </b>{{ apply_route.comment }}
                                </div>
                            </div>
                        </div>
                        <div class="col-lg-12"><br></div>
                        <div class="col-lg-12 text-center">
                          {% if apply_route.state == 'waiting' or apply_route.state == 'rejected' %}
                            <a href="{% url 'resolve-apply-route' apply_route.id  'accept' %}" class="btn btn-success">Aceptar</a>
                          {% endif %}
                          {% if apply_route.state == 'waiting' or apply_route.state == 'approach' %}
                            <a href="{% url 'resolve-apply-route' apply_route.id 'reject' %}" class="btn btn-danger">Rechazar</a>
                          {% endif %}
                        </div>
                        <div class="col-lg-12"><br></div>
                      {% endfor %}
                    {% endif %}
                </div>
          </div>
    </div>
{% endblock %}
